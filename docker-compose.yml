services:
  api:
    image: ghcr.io/elvinyao/confl-page-arrange:latest
    container_name: confl-api
    restart: unless-stopped
    expose:
      - "8787"
    environment:
      HOST: "0.0.0.0"
      PORT: "8787"
      HTTP_PROXY: ${HTTP_PROXY:-}
      HTTPS_PROXY: ${HTTPS_PROXY:-}
      NO_PROXY: ${NO_PROXY:-localhost,127.0.0.1,::1,api,web,.local,.internal,confluence.example.com}
      http_proxy: ${HTTP_PROXY:-}
      https_proxy: ${HTTPS_PROXY:-}
      no_proxy: ${NO_PROXY:-localhost,127.0.0.1,::1,api,web,.local,.internal,confluence.example.com}

  web:
    build:
      context: .
      dockerfile: Dockerfile.web
    container_name: confl-web
    restart: unless-stopped
    depends_on:
      - api
    ports:
      - "8080:80"
